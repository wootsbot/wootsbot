---
title: 쯇or qu칠 usar m치quinas de estado?
publishedAt: 2022-06-08T00:00:00Z
summary: Una de las bibliotecas clave que utilizo actualmente en mis desarrollos es XState. Es uno de los descubrimientos m치s importantes que he hecho recientemente sobre programaci칩n.
tags: ['xstate','javaScript','typescript']
author: wootsbot
---

Una de las bibliotecas clave que utilizo actualmente en mis desarrollos es XState. En esta peque침a publicaci칩n, Quiero mostrarte por qu칠, sinceramente, es uno de los descubrimientos m치s importantes que he hecho recientemente sobre programaci칩n y por qu칠 te recomiendo que lo implementes.

## 쯈u칠 es XState?

> XState es una biblioteca para crear, interpretar y ejecutar m치quinas de estado finito y diagramas de estado, as칤 como para administrar las invocaciones de esas m치quinas como actores.

Sinceramente tom칠 esta definici칩n del [sitio oficial](https://xstate.js.org/), pero no se preocupe si no esta familiarizado con los conceptos de m치quinas de estado y estados finitos, parecen complejos pero en realidad no lo son 游땦.

Si crees que necesitas ampliar tus conocimientos al respecto, en la documentaci칩n puedes encontrar los conceptos, pero en resumen, xstate te ayuda a definir de forma declarativa toda tu l칩gica de negocio de tus aplicaciones, facilitando su interceptaci칩n, interacci칩n y respuesta con una gran confianza.

## 쯇or qu칠 m치quinas de estado?

> M치quinas de estado: Una m치quina de estados finitos es un modelo matem치tico de computaci칩n que describe el comportamiento de un sistema que puede estar en un solo estado en un momento dado. Por ejemplo, supongamos que puede estar representado por una m치quina de estado con un n칰mero finito (2) de estados: dormido o despierto. En un momento dado, est치s dormido o despierto. Es imposible que est칠s dormido y despierto al mismo tiempo, y es imposible que no est칠s ni dormido ni despierto.

En realidad, una m치quina de estado es un modelo expl칤cito a lo largo del tiempo de su estado, por lo que le ayuda a definir su l칩gica de negocio de una manera m치s concisa, tambi칠n le ayuda a comunicarse mejor con UI/UX y otros compa침eros de equipo que no son desarrolladores, lo que hace que su producto sea m치s robusto y preparado para el futuro. Creo que lo hace atractivo para m칤 y darle una oportunidad.

## Visualizador y un ejemplo

Una gran ventaja de xstate es que tiene un visor fant치stico en l칤nea y en editores de texto, lo que le permite ver su gr치fico de estado en su totalidad.

as칤 que digamos que tenemos una solicitud para recuperar datos de una API, que representar칤amos de la siguiente manera.

Los estados que asignamos a nuestra m치quina son:

- `idle`: Es el inicio y es por defecto cuando arrancamos nuestra m치quina.
- `loading`: Este estado nos ayudara a saber que la llamada a la api ha iniciado y esta en proceso de ser resuelta.
- `failure`: Nos ayudar치 a saber si la llamada no tuvo 칠xito.
- `loaded`: Si la llamada es exitosa, pasaremos a este estado y nuestra m치quina terminar치, ya que es un estado de tipo `final`.

Los eventos que tendr치 nuestra m치quina son:

- `FETCH`: Nos ayudar치 a pasar del estado de `idle` al `loading`
- `FETCH_CANCEL`: Nos llevar치 de vuelta al estado `idle`
- `FETCH_RETRY`: Nos ayudar치 a volver al estado `loading` cuando estamos en un estado `failure`, un modo de reintento al llamar a la API.
- `FETCH_SUCCESS`: Pasar del estado de `loading` al estado `loaded`, como una forma de terminar la m치quina con 칠xito.
- `FETCH_ERROR`: Pasar del estado de `loading` al estado `failure`, esto sucede si hay un error en la llamada a la API.

<Image
  alt="xstate"
  src="/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/example_0.webp"
  width={1024}
  height={500}
  quality="75"
  priority
/>

En la pr칩xima iteraci칩n, ver치 c칩mo pas칩 del estado `idle`, con el evento `FETCH` al estado `loading`

<Image
  alt="xstate"
  src="/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/example_1.gif"
  width={1024}
  height={500}
  quality="75"
  unoptimized
/>

En el estado en que se encuentra la m치quina `loading`, entonces nos habilita 3 eventos que son `FETCH_CANCEL`, `FETCH_SUCCESS`, `FETCH_ERROR`

En este ejemplo simularemos que nuestro usuario quiere cancelar la llamada lo cual nos apoyar치 desde el evento `FETCH_CANCEL`, lo que el evento nos va a llevar del estado `loading` al estado `idle` y habilitar치 el evento nuevamente `FETCH`, esto para que pueda realizar el flujo de nuevo.

<Image
  alt="xstate"
  src="/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/example_3.gif"
  width={1024}
  height={500}
  quality="75"
  unoptimized
/>

Para simular una llamada a la api no es exitosa nos ayudar치 el evento `FETCH_ERROR`, nos va a llevar del estado `loading` al estado `failure`, con ayuda del evento `FETCH_ERROR`. y nos habilitar치 el evento `FETCH_RETRY` para poder hacer un reintento.

<Image
  alt="xstate"
  src="/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/example_4.gif"
  width={1024}
  height={500}
  quality="75"
  unoptimized
/>

As칤 que ahora estamos en un estado de `failure` y con el evento `FETCH_RETRY` vamos a regresar al estado `loading` para poder hacer un reintento.

<Image
  alt="xstate"
  src="/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/example_5.gif"
  width={1024}
  height={500}
  quality="75"
  unoptimized
/>

Con todos los estados expuestos en este momento, es hora de ver c칩mo llegamos al estado de `loaded`, nos apoyamos el evento `FETCH_SUCCESS`, y esto termina el flujo del estado de la m치quina.

<Image
  alt="xstate"
  src="/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/example_2.gif"
  width={1024}
  height={500}
  quality="75"
  unoptimized
/>

## Conclusi칩n

Realmente creo que una de las razones por las que las m치quinas de estados finitos se han vuelto tan populares es porque tener que escribir expl칤citamente todo tu estado te ayuda a pensar en un caos m치s extremo y probablemente a descubrir algunos errores que te perdiste en alguna parte. 游뱅
