---
title: '¬øQu√© es XState y por qu√© usar m√°quinas de estado?'
publishedAt: '2022-06-08'
summary: 'Una de las bibliotecas clave que utilizo actualmente en mis desarrollos es XState. En esta peque√±a publicaci√≥n, Quiero
mostrarte por qu√©, sinceramente, es uno de los descubrimientos m√°s importantes que he hecho recientemente sobre
programaci√≥n y por qu√© te recomiendo que lo implementes.'
image: '/static/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/preview.png'
tags: ['xstate', 'javaScript', 'typescript']
---

## ¬øQu√© es XState?

> XState es una biblioteca para crear, interpretar y ejecutar m√°quinas de estado finito y diagramas de estado, as√≠ como para administrar las invocaciones de esas m√°quinas como actores.

Sinceramente tom√© esta definici√≥n del [sitio oficial](https://xstate.js.org/), pero no se preocupe si no esta familiarizado con los conceptos de m√°quinas de estado y estados finitos, parecen complejos pero en realidad no lo son üòú.

Si crees que necesitas ampliar tus conocimientos al respecto, en la documentaci√≥n puedes encontrar los conceptos, pero en resumen, xstate te ayuda a definir de forma declarativa toda tu l√≥gica de negocio de tus aplicaciones, facilitando su interceptaci√≥n, interacci√≥n y respuesta con una gran confianza.

## ¬øPor qu√© m√°quinas de estado?

> M√°quinas de estado: Una m√°quina de estados finitos es un modelo matem√°tico de computaci√≥n que describe el comportamiento de un sistema que puede estar en un solo estado en un momento dado. Por ejemplo, supongamos que puede estar representado por una m√°quina de estado con un n√∫mero finito (2) de estados: dormido o despierto. En un momento dado, est√°s dormido o despierto. Es imposible que est√©s dormido y despierto al mismo tiempo, y es imposible que no est√©s ni dormido ni despierto.

En realidad, una m√°quina de estado es un modelo expl√≠cito a lo largo del tiempo de su estado, por lo que le ayuda a definir su l√≥gica de negocio de una manera m√°s concisa, tambi√©n le ayuda a comunicarse mejor con UI/UX y otros compa√±eros de equipo que no son desarrolladores, lo que hace que su producto sea m√°s robusto y preparado para el futuro. Creo que lo hace atractivo para m√≠ y darle una oportunidad.

## Visualizador y un ejemplo

Una gran ventaja de xstate es que tiene un visor fant√°stico en l√≠nea y en editores de texto, lo que le permite ver su gr√°fico de estado en su totalidad.

as√≠ que digamos que tenemos una solicitud para recuperar datos de una API, que representar√≠amos de la siguiente manera.

Los estados que asignamos a nuestra m√°quina son:

- `idle`: Es el inicio y es por defecto cuando arrancamos nuestra m√°quina.
- `loading`: Este estado nos ayudara a saber que la llamada a la api ha iniciado y esta en proceso de ser resuelta.
- `failure`: Nos ayudar√° a saber si la llamada no tuvo √©xito.
- `loaded`: Si la llamada es exitosa, pasaremos a este estado y nuestra m√°quina terminar√°, ya que es un estado de tipo `final`.

Los eventos que tendr√° nuestra m√°quina son:

- `FETCH`: Nos ayudar√° a pasar del estado de `idle` al `loading`
- `FETCH_CANCEL`: Nos llevar√° de vuelta al estado `idle`
- `FETCH_RETRY`: Nos ayudar√° a volver al estado `loading` cuando estamos en un estado `failure`, un modo de reintento al llamar a la API.
- `FETCH_SUCCESS`: Pasar del estado de `loading` al estado `loaded`, como una forma de terminar la m√°quina con √©xito.
- `FETCH_ERROR`: Pasar del estado de `loading` al estado `failure`, esto sucede si hay un error en la llamada a la API.

<Image
  alt="Jorge Luis Calleja Alvarado"
  src="/static/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/example_0.png"
  width={155}
  height={65}
  layout="responsive"
  quality="100"
  priority
/>

En la pr√≥xima iteraci√≥n, ver√° c√≥mo pas√≥ del estado `idle`, con el evento `FETCH` al estado `loading`

<Image
  alt="Jorge Luis Calleja Alvarado"
  src="/static/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/example_1.gif"
  width={155}
  height={65}
  layout="responsive"
  quality="100"
  priority
/>

En el estado en que se encuentra la m√°quina `loading`, entonces nos habilita 3 eventos que son `FETCH_CANCEL`, `FETCH_SUCCESS`, `FETCH_ERROR`

En este ejemplo simularemos que nuestro usuario quiere cancelar la llamada lo cual nos apoyar√° desde el evento `FETCH_CANCEL`, lo que el evento nos va a llevar del estado `loading` al estado `idle` y habilitar√° el evento nuevamente `FETCH`, esto para que pueda realizar el flujo de nuevo.

<Image
  alt="Jorge Luis Calleja Alvarado"
  src="/static/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/example_3.gif"
  width={155}
  height={65}
  layout="responsive"
  quality="100"
  priority
/>

Para simular una llamada a la api no es exitosa nos ayudar√° el evento `FETCH_ERROR`, nos va a llevar del estado `loading` al estado `failure`, con ayuda del evento `FETCH_ERROR`. y nos habilitar√° el evento `FETCH_RETRY` para poder hacer un reintento.

<Image
  alt="Jorge Luis Calleja Alvarado"
  src="/static/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/example_4.gif"
  width={155}
  height={65}
  layout="responsive"
  quality="100"
  priority
/>

As√≠ que ahora estamos en un estado de `failure` y con el evento `FETCH_RETRY` vamos a regresar al estado `loading` para poder hacer un reintento.

<Image
  alt="Jorge Luis Calleja Alvarado"
  src="/static/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/example_5.gif"
  width={155}
  height={65}
  layout="responsive"
  quality="100"
  priority
/>

Con todos los estados expuestos en este momento, es hora de ver c√≥mo llegamos al estado de `loaded`, nos apoyamos el evento `FETCH_SUCCESS`, y esto termina el flujo del estado de la m√°quina.

<Image
  alt="Jorge Luis Calleja Alvarado"
  src="/static/images/blog/que-es-xstate-y-por-que-usar-maquinas-de-estado/example_2.gif"
  width={155}
  height={65}
  layout="responsive"
  quality="100"
  priority
/>

## Conclusi√≥n

Realmente creo que una de las razones por las que las m√°quinas de estados finitos se han vuelto tan populares es porque tener que escribir expl√≠citamente todo tu estado te ayuda a pensar en un caos m√°s extremo y probablemente a descubrir algunos errores que te perdiste en alguna parte. ü§ó
